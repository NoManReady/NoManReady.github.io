(window.webpackJsonp=window.webpackJsonp||[]).push([[281],{99:function(t,e,a){"use strict";a.r(e);var i={0:"点击生成数据",1:"数据生成中...",2:"数据生成完毕",3:"开始过滤数据",4:"数据过滤完成",5:"数据植入完成"},s=null,n={name:"mockjs-bigdata",data:function(){return{dataSize:1e4,filterKey:"123",list:[],temp:[],worker:null,dataStatus:0,beginTime:0,endTime:0,pageSize:1e3,fetchFromOrigin:!0}},mounted:function(){"undefined"!=typeof Worker?(this.worker=new Worker("/worker.js"),this.worker.onmessage=this._onMessage):alert("Your browser don't support Worker.")},beforeDestroy:function(){this.worker.terminate()},computed:{dataStatusText:function(){return i[this.dataStatus]},btnDisabled:function(){return 1===this.dataStatus||3===this.dataStatus}},watch:{list:function(){clearTimeout(s),s=setTimeout((function(){var t=document.querySelector("#filterRef");t.scrollTop=t.scrollHeight,s=null}),100)}},methods:{_onAddFilterData:function(){this.list=Object.freeze(this.list.concat(this.temp)),this.temp=[],this.dataStatus=5},_onGeneratorBegin:function(){this.worker&&(this.dataStatus=1,this.beginTime=Date.now(),this.worker.postMessage({type:"data-begin",size:+this.dataSize,from:this.fetchFromOrigin?"origin":"local"}))},_onGeneratorEnd:function(t){this.dataStatus=2,this.endTime=Date.now()},_onDataFilterBegin:function(){this.pageSize&&(this.list=[],this.temp=[],this.dataStatus=3,this.beginTime=Date.now(),this.worker.postMessage({type:"data-filter",size:this.pageSize,key:this.filterKey}))},_onDataFilterEnd:function(t){var e;t.data.end&&(this.dataStatus=4,this.endTime=Date.now());var a=t.data.data;this.list.length>1e3?this.temp=Object.freeze(this.temp.concat(a)):a&&a.length&&(e=this.list).push.apply(e,a)},_onMessage:function(t){switch(t.data.type){case"data-begin":this._onGeneratorBegin(t);break;case"data-end":this._onGeneratorEnd(t);break;case"data-filter":this._onDataFilterEnd(t)}}}},r=a(0),o=Object(r.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"mockjs-bigdata box"},[a("div",{staticClass:"mb10"},[a("strong",[t._v(t._s(t.dataStatusText))]),a("span",{directives:[{name:"show",rawName:"v-show",value:!t.btnDisabled&&0!==t.dataStatus&&5!==t.dataStatus,expression:"!btnDisabled&&dataStatus!==0&&dataStatus!==5"}]},[t._v("："+t._s(this.beginTime+"-"+this.endTime)+"="+t._s(this.endTime-this.beginTime))])]),a("div",{staticClass:"mb10"},[a("span",{staticClass:"mr10 w100"},[t._v("数据size:")]),a("label",{staticClass:"mr10"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.fetchFromOrigin,expression:"fetchFromOrigin"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.fetchFromOrigin)?t._i(t.fetchFromOrigin,null)>-1:t.fetchFromOrigin},on:{change:function(e){var a=t.fetchFromOrigin,i=e.target,s=!!i.checked;if(Array.isArray(a)){var n=t._i(a,null);i.checked?n<0&&(t.fetchFromOrigin=a.concat([null])):n>-1&&(t.fetchFromOrigin=a.slice(0,n).concat(a.slice(n+1)))}else t.fetchFromOrigin=s}}}),a("span",[t._v("是否远程获取数据")])]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.dataSize,expression:"dataSize"}],staticClass:"mr10",attrs:{type:"number",disabled:t.btnDisabled||t.fetchFromOrigin},domProps:{value:t.dataSize},on:{input:function(e){e.target.composing||(t.dataSize=e.target.value)}}}),a("button",{staticClass:"btn",attrs:{disabled:t.btnDisabled},on:{click:t._onGeneratorBegin}},[t._v("开始生成数据")])]),a("div",{staticClass:"mb10"},[a("span",{staticClass:"mr10"},[t._v("分片size:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.pageSize,expression:"pageSize"}],staticClass:"mr10 w50",attrs:{type:"number",disabled:t.btnDisabled||t.dataStatus<2},domProps:{value:t.pageSize},on:{input:function(e){e.target.composing||(t.pageSize=e.target.value)}}}),a("span",{staticClass:"mr10"},[t._v("filter:")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.filterKey,expression:"filterKey"}],staticClass:"mr10 w50",attrs:{type:"text",disabled:t.btnDisabled||t.dataStatus<2},domProps:{value:t.filterKey},on:{input:function(e){e.target.composing||(t.filterKey=e.target.value)}}}),a("button",{staticClass:"btn mr10",attrs:{disabled:t.btnDisabled||t.dataStatus<2},on:{click:t._onDataFilterBegin}},[t._v("开始过滤")]),a("button",{staticClass:"btn",attrs:{disabled:t.temp.length&&4!==t.dataStatus},on:{click:t._onAddFilterData}},[t._v("加入数据("+t._s(t.temp.length)+")")])]),a("div",{staticClass:" mt10"},[a("h4",[t._v("搜索到的数据("+t._s(t.list.length)+")：")]),a("ul",{ref:"filterRef",staticClass:"mt20 box",staticStyle:{height:"20rem",overflow:"auto","list-style":"none"},attrs:{id:"filterRef"}},[t._l(t.list,(function(e,i){return a("li",{directives:[{name:"show",rawName:"v-show",value:t.list.length>0,expression:"list.length>0"}],key:e.name+e.id},[t._v(t._s(i+1)+":"+t._s(e.name))])})),a("li",{directives:[{name:"show",rawName:"v-show",value:0===t.list.length,expression:"list.length===0"}],staticClass:"tc"},[a("small",[t._v("暂无匹配数据！")])])],2)])])}),[],!1,null,"5242038a",null);e.default=o.exports}}]);